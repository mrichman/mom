USE [Mom-Nutri-Health]
GO

IF OBJECT_ID('[dbo].[Amazon_CMS_Insert]') IS NOT NULL
BEGIN
    DROP PROC [dbo].[Amazon_CMS_Insert]
END
GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

CREATE PROC [dbo].[Amazon_CMS_Insert]
    @CUSTNUM numeric(10, 0),
    @CL_KEY char(9),
    @ODR_DATE datetime,
    @HOLD_TYPE char(1),
    @PERM_HOLD bit,
    @SYS_HOLD bit,
    @HOLD_DATE datetime,
    @REL_DATE datetime,
    @CLEAR_DATE datetime,
    @SHIP_DATE datetime,
    @CCHECK char(1),
    @PAYMETHOD char(2),
    @CASHONLY bit,
    @CARDNUM char(60),
    @CARDTYPE char(2),
    @EXP char(5),
    @APPROVAL char(10),
    @CCCORR bit,
    @SHIPLIST char(3),
    @TAX numeric(11, 2),
    @SHIPPING numeric(10, 2),
    @OTHERCOST numeric(10, 2),
    @CHECKAMOUN numeric(11, 2),
    @ORD_TOTAL numeric(11, 2),
    @CHARGED numeric(11, 2),
    @CORRECTIN bit,
    @CORRECTLC char(1),
    @INVOICED bit,
    @LASTINV char(1),
    @VCOUNT numeric(2, 0),
    @LABELED bit,
    @LABELS numeric(2, 0),
    @DLABELS numeric(2, 0),
    @COMPLETED bit,
    @CAN_ORD bit,
    @MULTISHIP bit,
    @NINV numeric(9, 2),
    @NFILL numeric(9, 2),
    @NPACK numeric(9, 2),
    @NSHIP numeric(9, 2),
    @NBOR numeric(9, 2),
    @VBOR numeric(9, 2),
    @VDSB numeric(9, 2),
    @VITEMHOLDS numeric(9, 2),
    @NALL numeric(9, 2),
    @NITEMHOLDS numeric(9, 2),
    @EXTRA numeric(3, 0),
    @SHIPNUM numeric(10, 0),
    @DORD numeric(9, 2),
    @DBOR numeric(9, 2),
    @DFILL numeric(9, 2),
    @DPACK numeric(9, 2),
    @DSHIP numeric(9, 2),
    @DALL numeric(9, 2),
    @PROCSSD bit,
    @USERID char(3),
    @LAST_USER char(3),
    @EXTRA2 char(3),
    @CHECKNUM char(20),
    @PREVORD numeric(8, 0),
    @CZONE char(3),
    @C_TABLE char(3),
    @PICKED bit,
    @VNTM numeric(9, 2),
    @SHIPTYPE char(1),
    @NTAXRATE numeric(7, 4),
    @STAXRATE numeric(7, 4),
    @CTAXRATE numeric(7, 4),
    @ITAXRATE numeric(7, 4),
    @TAXSHIP bit,
    @DUE_DAYS numeric(3, 0),
    @TB_MERCH numeric(12, 2),
    @SALES_ID char(3),
    @TB_SHIP numeric(10, 2),
    @NOTYETUSED bit,
    @TB_TAX numeric(10, 2),
    @TB_NONTAX numeric(12, 2),
    @SHIPMODIFY bit,
    @CATCODE char(6),
    @NEEDWEIGHT bit,
    @TAXMODIFY bit,
    @ORDER_ST2 char(2),
    @TELE_CODE numeric(1, 0),
    @TELEDONE bit,
    @OVERPAY numeric(12, 2),
    @ACC_STATE char(2),
    @NEXT_PAY numeric(12, 2),
    @TB_FINCHAR numeric(11, 2),
    @ALT_ORDER char(25),
    @NTAXSHIP bit,
    @QUOTATION bit,
    @INTERNETID char(32),
    @POPENTRY bit,
    @CARDINLIST bit,
    @DISCT_PCT numeric(4, 1),
    @DISCT_DAYS numeric(3, 0),
    @MULTIPAY bit,
    @CC_CID char(32),
    @POINTS_USD numeric(8, 0),
    @ORDERTYPE char(6),
    @PONUMBER char(25),
    @CARDHOLDER char(30),
    @NEEDSCAN bit,
    @NEED_GC bit,
    @BILLED bit,
    @R_MERCH numeric(10, 2),
    @R_TAX numeric(8, 2),
    @NR_MERCH numeric(10, 2),
    @NR_TAX numeric(8, 2),
    @P_MERCH numeric(10, 2),
    @P_TAX numeric(8, 2),
    @P_SHIP numeric(8, 2),
    @HOLDNOTE char(50),
    @SOLDNUM numeric(10, 0),
    @TPSHIPTYPE numeric(1, 0),
    @TPSHIPWHAT char(1),
    @TPSHIPACCT char(14),
    @TPSHIPCC char(19),
    @TPSHIPEXP char(5),
    @ENTRYTIME datetime,
    @FREIGHTCOL bit,
    @INTERNET bit,
    @PROCSSDBY char(3),
    @CCINQ_REQ bit,
    @REMOVECC bit,
    @ITEM_ID numeric(12, 0),
    @NO_PROMO bit,
    @PRIORITY char(1),
    @CHARGE_ALL bit,
    @ISSUE_NUM char(2),
    @FRDATE char(5),
    @ORDPROMO char(10),
    @ORDERSET bit,
    @ROUTINGNUM char(32),
    @ACCOUNTNUM char(60),
    @ACCTTYPE char(10),
    @BANKNAME char(30),
    @PAYPALID char(90),
    @PINENTRY bit,
    @BADLABEL bit,
    @HOLDCODE char(10),
    @DUE_ONDATE datetime,
    @ENCTYPE int,
    @VATSHIP numeric(10, 2),
    @URL_ID numeric(18, 0),
    @NPMMITEM numeric(9, 2),
    @STORECODE char(10),
    @POPNUM numeric(10, 0),
    @BANKSTATE char(3),
    @DRLICENSE char(32),
    @DLSTATE char(3),
    @ACCTTYPE2 char(1),
    @EDI bit,
    @EDIORDER numeric(12, 0)
AS
	SET NOCOUNT ON
	SET XACT_ABORT ON

	BEGIN TRAN

	INSERT INTO [dbo].[CMS] ([CUSTNUM], [CL_KEY], [ODR_DATE], [HOLD_TYPE], [PERM_HOLD], [SYS_HOLD], [HOLD_DATE], [REL_DATE], [CLEAR_DATE], [SHIP_DATE], [CCHECK], [PAYMETHOD], [CASHONLY], [CARDNUM], [CARDTYPE], [EXP], [APPROVAL], [CCCORR], [SHIPLIST], [TAX], [SHIPPING], [OTHERCOST], [CHECKAMOUN], [ORD_TOTAL], [CHARGED], [CORRECTIN], [CORRECTLC], [INVOICED], [LASTINV], [VCOUNT], [LABELED], [LABELS], [DLABELS], [COMPLETED], [CAN_ORD], [MULTISHIP], [NINV], [NFILL], [NPACK], [NSHIP], [NBOR], [VBOR], [VDSB], [VITEMHOLDS], [NALL], [NITEMHOLDS], [EXTRA], [SHIPNUM], [DORD], [DBOR], [DFILL], [DPACK], [DSHIP], [DALL], [PROCSSD], [USERID], [LAST_USER], [EXTRA2], [CHECKNUM], [PREVORD], [CZONE], [C_TABLE], [PICKED], [VNTM], [SHIPTYPE], [NTAXRATE], [STAXRATE], [CTAXRATE], [ITAXRATE], [TAXSHIP], [DUE_DAYS], [TB_MERCH], [SALES_ID], [TB_SHIP], [NOTYETUSED], [TB_TAX], [TB_NONTAX], [SHIPMODIFY], [CATCODE], [NEEDWEIGHT], [TAXMODIFY], [ORDER_ST2], [TELE_CODE], [TELEDONE], [OVERPAY], [ACC_STATE], [NEXT_PAY], [TB_FINCHAR], [ALT_ORDER], [NTAXSHIP], [QUOTATION], [INTERNETID], [POPENTRY], [CARDINLIST], [DISCT_PCT], [DISCT_DAYS], [MULTIPAY], [CC_CID], [POINTS_USD], [ORDERTYPE], [PONUMBER], [CARDHOLDER], [NEEDSCAN], [NEED_GC], [BILLED], [R_MERCH], [R_TAX], [NR_MERCH], [NR_TAX], [P_MERCH], [P_TAX], [P_SHIP], [HOLDNOTE], [SOLDNUM], [TPSHIPTYPE], [TPSHIPWHAT], [TPSHIPACCT], [TPSHIPCC], [TPSHIPEXP], [ENTRYTIME], [FREIGHTCOL], [INTERNET], [PROCSSDBY], [CCINQ_REQ], [REMOVECC], [ITEM_ID], [NO_PROMO], [PRIORITY], [CHARGE_ALL], [ISSUE_NUM], [FRDATE], [ORDPROMO], [ORDERSET], [ROUTINGNUM], [ACCOUNTNUM], [ACCTTYPE], [BANKNAME], [PAYPALID], [PINENTRY], [BADLABEL], [HOLDCODE], [DUE_ONDATE], [ENCTYPE], [VATSHIP], [URL_ID], [NPMMITEM], [STORECODE], [POPNUM], [BANKSTATE], [DRLICENSE], [DLSTATE], [ACCTTYPE2], [EDI], [EDIORDER])
	SELECT @CUSTNUM, @CL_KEY, @ODR_DATE, @HOLD_TYPE, @PERM_HOLD, @SYS_HOLD, @HOLD_DATE, @REL_DATE, @CLEAR_DATE, @SHIP_DATE, @CCHECK, @PAYMETHOD, @CASHONLY, @CARDNUM, @CARDTYPE, @EXP, @APPROVAL, @CCCORR, @SHIPLIST, @TAX, @SHIPPING, @OTHERCOST, @CHECKAMOUN, @ORD_TOTAL, @CHARGED, @CORRECTIN, @CORRECTLC, @INVOICED, @LASTINV, @VCOUNT, @LABELED, @LABELS, @DLABELS, @COMPLETED, @CAN_ORD, @MULTISHIP, @NINV, @NFILL, @NPACK, @NSHIP, @NBOR, @VBOR, @VDSB, @VITEMHOLDS, @NALL, @NITEMHOLDS, @EXTRA, @SHIPNUM, @DORD, @DBOR, @DFILL, @DPACK, @DSHIP, @DALL, @PROCSSD, @USERID, @LAST_USER, @EXTRA2, @CHECKNUM, @PREVORD, @CZONE, @C_TABLE, @PICKED, @VNTM, @SHIPTYPE, @NTAXRATE, @STAXRATE, @CTAXRATE, @ITAXRATE, @TAXSHIP, @DUE_DAYS, @TB_MERCH, @SALES_ID, @TB_SHIP, @NOTYETUSED, @TB_TAX, @TB_NONTAX, @SHIPMODIFY, @CATCODE, @NEEDWEIGHT, @TAXMODIFY, @ORDER_ST2, @TELE_CODE, @TELEDONE, @OVERPAY, @ACC_STATE, @NEXT_PAY, @TB_FINCHAR, @ALT_ORDER, @NTAXSHIP, @QUOTATION, @INTERNETID, @POPENTRY, @CARDINLIST, @DISCT_PCT, @DISCT_DAYS, @MULTIPAY, @CC_CID, @POINTS_USD, @ORDERTYPE, @PONUMBER, @CARDHOLDER, @NEEDSCAN, @NEED_GC, @BILLED, @R_MERCH, @R_TAX, @NR_MERCH, @NR_TAX, @P_MERCH, @P_TAX, @P_SHIP, @HOLDNOTE, @SOLDNUM, @TPSHIPTYPE, @TPSHIPWHAT, @TPSHIPACCT, @TPSHIPCC, @TPSHIPEXP, @ENTRYTIME, @FREIGHTCOL, @INTERNET, @PROCSSDBY, @CCINQ_REQ, @REMOVECC, @ITEM_ID, @NO_PROMO, @PRIORITY, @CHARGE_ALL, @ISSUE_NUM, @FRDATE, @ORDPROMO, @ORDERSET, @ROUTINGNUM, @ACCOUNTNUM, @ACCTTYPE, @BANKNAME, @PAYPALID, @PINENTRY, @BADLABEL, @HOLDCODE, @DUE_ONDATE, @ENCTYPE, @VATSHIP, @URL_ID, @NPMMITEM, @STORECODE, @POPNUM, @BANKSTATE, @DRLICENSE, @DLSTATE, @ACCTTYPE2, @EDI, @EDIORDER

	-- Begin Return Select <- do not remove
	SELECT [ORDERNO], [CUSTNUM], [CL_KEY], [ODR_DATE], [HOLD_TYPE], [PERM_HOLD], [SYS_HOLD], [HOLD_DATE], [REL_DATE], [CLEAR_DATE], [SHIP_DATE], [CCHECK], [PAYMETHOD], [CASHONLY], [CARDNUM], [CARDTYPE], [EXP], [APPROVAL], [CCCORR], [SHIPLIST], [TAX], [SHIPPING], [OTHERCOST], [CHECKAMOUN], [ORD_TOTAL], [CHARGED], [CORRECTIN], [CORRECTLC], [INVOICED], [LASTINV], [VCOUNT], [LABELED], [LABELS], [DLABELS], [COMPLETED], [CAN_ORD], [MULTISHIP], [NINV], [NFILL], [NPACK], [NSHIP], [NBOR], [VBOR], [VDSB], [VITEMHOLDS], [NALL], [NITEMHOLDS], [EXTRA], [SHIPNUM], [DORD], [DBOR], [DFILL], [DPACK], [DSHIP], [DALL], [PROCSSD], [USERID], [LAST_USER], [EXTRA2], [CHECKNUM], [PREVORD], [CZONE], [C_TABLE], [PICKED], [VNTM], [SHIPTYPE], [NTAXRATE], [STAXRATE], [CTAXRATE], [ITAXRATE], [TAXSHIP], [DUE_DAYS], [TB_MERCH], [SALES_ID], [TB_SHIP], [NOTYETUSED], [TB_TAX], [TB_NONTAX], [SHIPMODIFY], [CATCODE], [NEEDWEIGHT], [TAXMODIFY], [ORDER_ST2], [TELE_CODE], [TELEDONE], [OVERPAY], [ACC_STATE], [NEXT_PAY], [TB_FINCHAR], [ALT_ORDER], [NTAXSHIP], [QUOTATION], [INTERNETID], [POPENTRY], [CARDINLIST], [DISCT_PCT], [DISCT_DAYS], [MULTIPAY], [CC_CID], [POINTS_USD], [ORDERTYPE], [PONUMBER], [CARDHOLDER], [NEEDSCAN], [NEED_GC], [BILLED], [R_MERCH], [R_TAX], [NR_MERCH], [NR_TAX], [P_MERCH], [P_TAX], [P_SHIP], [HOLDNOTE], [SOLDNUM], [TPSHIPTYPE], [TPSHIPWHAT], [TPSHIPACCT], [TPSHIPCC], [TPSHIPEXP], [ENTRYTIME], [FREIGHTCOL], [INTERNET], [PROCSSDBY], [CCINQ_REQ], [REMOVECC], [ITEM_ID], [NO_PROMO], [PRIORITY], [CHARGE_ALL], [ISSUE_NUM], [FRDATE], [ORDPROMO], [ORDERSET], [ROUTINGNUM], [ACCOUNTNUM], [ACCTTYPE], [BANKNAME], [PAYPALID], [PINENTRY], [BADLABEL], [HOLDCODE], [DUE_ONDATE], [ENCTYPE], [VATSHIP], [URL_ID], [NPMMITEM], [STORECODE], [POPNUM], [BANKSTATE], [DRLICENSE], [DLSTATE], [ACCTTYPE2], [EDI], [EDIORDER]
	FROM   [dbo].[CMS]
	WHERE  [ORDERNO] = SCOPE_IDENTITY()
	-- End Return Select <- do not remove

	COMMIT
GO
